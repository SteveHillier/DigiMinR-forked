<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 6 Comparison of XRPD data from Scotland and Mars | Digital Soil Mineralogy with R</title>
  <meta name="description" content="An online course detailing various methods for data-driven analysis of X-ray powder diffraction using R" />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 6 Comparison of XRPD data from Scotland and Mars | Digital Soil Mineralogy with R" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="/figures/dsm_graphic.png" />
  <meta property="og:description" content="An online course detailing various methods for data-driven analysis of X-ray powder diffraction using R" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 6 Comparison of XRPD data from Scotland and Mars | Digital Soil Mineralogy with R" />
  
  <meta name="twitter:description" content="An online course detailing various methods for data-driven analysis of X-ray powder diffraction using R" />
  <meta name="twitter:image" content="/figures/dsm_graphic.png" />

<meta name="author" content="Benjamin Butler and Steve Hillier" />


<meta name="date" content="2021-09-02" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="mars.html"/>
<link rel="next" href="references.html"/>
<script src="libs/header-attrs-2.10/header-attrs.js"></script>
<script src="libs/jquery-3.5.1/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/font-awesome-5.13.0/js/script.js"></script>
<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.0.4.1/leaflet.js"></script>
<script src="libs/plotly-binding-4.9.4.1/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.1/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.57.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.57.1/plotly-latest.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Digital Soil Mineralogy with R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#prerequisites"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#code-conventions"><i class="fa fa-check"></i>Code Conventions</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#what-to-expect"><i class="fa fa-check"></i>What to expect</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#about-the-authors"><i class="fa fa-check"></i>About the authors</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowledgments"><i class="fa fa-check"></i>Acknowledgments</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Working with XRPD data in R</a>
<ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#basic-form"><i class="fa fa-check"></i><b>1.1</b> The basic form of XRPD data</a></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#loading-data"><i class="fa fa-check"></i><b>1.2</b> Loading XRPD data</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="intro.html"><a href="intro.html#powDLL"><i class="fa fa-check"></i><b>1.2.1</b> Option 1: PowDLL</a></li>
<li class="chapter" data-level="1.2.2" data-path="intro.html"><a href="intro.html#loading-directly"><i class="fa fa-check"></i><b>1.2.2</b> Option 2: Loading directly into R</a></li>
<li class="chapter" data-level="1.2.3" data-path="intro.html"><a href="intro.html#loading-multiple"><i class="fa fa-check"></i><b>1.2.3</b> Loading multiple files</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="intro.html"><a href="intro.html#plotting-data"><i class="fa fa-check"></i><b>1.3</b> Plotting XRPD data</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="intro.html"><a href="intro.html#plotting-xy-objects"><i class="fa fa-check"></i><b>1.3.1</b> Plotting <code>XY</code> objects</a></li>
<li class="chapter" data-level="1.3.2" data-path="intro.html"><a href="intro.html#plotting-multixy-objects"><i class="fa fa-check"></i><b>1.3.2</b> Plotting <code>multiXY</code> objects</a></li>
<li class="chapter" data-level="1.3.3" data-path="intro.html"><a href="intro.html#ggplot2-intro"><i class="fa fa-check"></i><b>1.3.3</b> Modifying plots with <strong>ggplot2</strong></a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="intro.html"><a href="intro.html#manipulating-data"><i class="fa fa-check"></i><b>1.4</b> Manipulating XRPD data</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="intro.html"><a href="intro.html#subsetting"><i class="fa fa-check"></i><b>1.4.1</b> Subsetting XRPD data</a></li>
<li class="chapter" data-level="1.4.2" data-path="intro.html"><a href="intro.html#transformations"><i class="fa fa-check"></i><b>1.4.2</b> Transformations of count intensities</a></li>
<li class="chapter" data-level="1.4.3" data-path="intro.html"><a href="intro.html#interpolation"><i class="fa fa-check"></i><b>1.4.3</b> Interpolation</a></li>
<li class="chapter" data-level="1.4.4" data-path="intro.html"><a href="intro.html#alignment"><i class="fa fa-check"></i><b>1.4.4</b> Alignment</a></li>
<li class="chapter" data-level="1.4.5" data-path="intro.html"><a href="intro.html#background"><i class="fa fa-check"></i><b>1.4.5</b> Background fitting</a></li>
<li class="chapter" data-level="1.4.6" data-path="intro.html"><a href="intro.html#to-data-frame"><i class="fa fa-check"></i><b>1.4.6</b> Converting to and from data frames</a></li>
<li class="chapter" data-level="1.4.7" data-path="intro.html"><a href="intro.html#two-theta-transform"><i class="fa fa-check"></i><b>1.4.7</b> 2θ transformation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="quant.html"><a href="quant.html"><i class="fa fa-check"></i><b>2</b> Quantitative phase analysis</a>
<ul>
<li class="chapter" data-level="2.1" data-path="quant.html"><a href="quant.html#full-pattern-summation-with-powdr"><i class="fa fa-check"></i><b>2.1</b> Full pattern summation with <strong>powdR</strong></a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="quant.html"><a href="quant.html#powdRlib"><i class="fa fa-check"></i><b>2.1.1</b> The <code>powdRlib</code> object</a></li>
<li class="chapter" data-level="2.1.2" data-path="quant.html"><a href="quant.html#full-pattern-summation-with-fps"><i class="fa fa-check"></i><b>2.1.2</b> Full pattern summation with <code>fps()</code></a></li>
<li class="chapter" data-level="2.1.3" data-path="quant.html"><a href="quant.html#afps"><i class="fa fa-check"></i><b>2.1.3</b> Automated full pattern summation with <code>afps()</code></a></li>
<li class="chapter" data-level="2.1.4" data-path="quant.html"><a href="quant.html#additional-fps-and-afps-functionality"><i class="fa fa-check"></i><b>2.1.4</b> Additional <code>fps()</code> and <code>afps()</code> functionality</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="quant.html"><a href="quant.html#plotting-powdrfps-and-powdrafps-objects"><i class="fa fa-check"></i><b>2.2</b> Plotting <code>powdRfps</code> and <code>powdRafps</code> objects</a></li>
<li class="chapter" data-level="2.3" data-path="quant.html"><a href="quant.html#quantifying-multiple-samples"><i class="fa fa-check"></i><b>2.3</b> Quantifying multiple samples</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="quant.html"><a href="quant.html#lapply"><i class="fa fa-check"></i><b>2.3.1</b> <code>lapply()</code></a></li>
<li class="chapter" data-level="2.3.2" data-path="quant.html"><a href="quant.html#parallel-processing"><i class="fa fa-check"></i><b>2.3.2</b> Parallel processing</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="quant.html"><a href="quant.html#summarising-mineralogy"><i class="fa fa-check"></i><b>2.4</b> Summarising mineralogy</a></li>
<li class="chapter" data-level="2.5" data-path="quant.html"><a href="quant.html#the-powdr-shiny-app"><i class="fa fa-check"></i><b>2.5</b> The powdR Shiny app</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="machine-learning.html"><a href="machine-learning.html"><i class="fa fa-check"></i><b>3</b> Machine learning with soil XRPD data</a>
<ul>
<li class="chapter" data-level="3.1" data-path="machine-learning.html"><a href="machine-learning.html#loading-packages-and-data"><i class="fa fa-check"></i><b>3.1</b> Loading packages and data</a></li>
<li class="chapter" data-level="3.2" data-path="machine-learning.html"><a href="machine-learning.html#cubist-exploration"><i class="fa fa-check"></i><b>3.2</b> Data exploration</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="machine-learning.html"><a href="machine-learning.html#spatial-data"><i class="fa fa-check"></i><b>3.2.1</b> Spatial data</a></li>
<li class="chapter" data-level="3.2.2" data-path="machine-learning.html"><a href="machine-learning.html#geochemical-data"><i class="fa fa-check"></i><b>3.2.2</b> Geochemical data</a></li>
<li class="chapter" data-level="3.2.3" data-path="machine-learning.html"><a href="machine-learning.html#xrpd-data"><i class="fa fa-check"></i><b>3.2.3</b> XRPD data</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="machine-learning.html"><a href="machine-learning.html#cubist-pretreatment"><i class="fa fa-check"></i><b>3.3</b> Data pre-treatment</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="machine-learning.html"><a href="machine-learning.html#alignment-1"><i class="fa fa-check"></i><b>3.3.1</b> Alignment</a></li>
<li class="chapter" data-level="3.3.2" data-path="machine-learning.html"><a href="machine-learning.html#subsetting-1"><i class="fa fa-check"></i><b>3.3.2</b> Subsetting</a></li>
<li class="chapter" data-level="3.3.3" data-path="machine-learning.html"><a href="machine-learning.html#mean-centering"><i class="fa fa-check"></i><b>3.3.3</b> Mean centering</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="machine-learning.html"><a href="machine-learning.html#creation-of-training-and-test-datasets"><i class="fa fa-check"></i><b>3.4</b> Creation of training and test datasets</a></li>
<li class="chapter" data-level="3.5" data-path="machine-learning.html"><a href="machine-learning.html#using-cubist"><i class="fa fa-check"></i><b>3.5</b> Using Cubist</a></li>
<li class="chapter" data-level="3.6" data-path="machine-learning.html"><a href="machine-learning.html#inspection-of-cubist-models"><i class="fa fa-check"></i><b>3.6</b> Inspection of Cubist models</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="cluster-analysis.html"><a href="cluster-analysis.html"><i class="fa fa-check"></i><b>4</b> Cluster analysis of soil XRPD data</a>
<ul>
<li class="chapter" data-level="4.1" data-path="cluster-analysis.html"><a href="cluster-analysis.html#loading-packages-and-data-1"><i class="fa fa-check"></i><b>4.1</b> Loading packages and data</a></li>
<li class="chapter" data-level="4.2" data-path="cluster-analysis.html"><a href="cluster-analysis.html#clustering-pca"><i class="fa fa-check"></i><b>4.2</b> Principal component analysis</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="cluster-analysis.html"><a href="cluster-analysis.html#interpreting-principal-components"><i class="fa fa-check"></i><b>4.2.1</b> Interpreting principal components</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="cluster-analysis.html"><a href="cluster-analysis.html#fuzzy-clustering"><i class="fa fa-check"></i><b>4.3</b> Fuzzy clustering</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="cluster-analysis.html"><a href="cluster-analysis.html#cluster-membership"><i class="fa fa-check"></i><b>4.3.1</b> Cluster membership</a></li>
<li class="chapter" data-level="4.3.2" data-path="cluster-analysis.html"><a href="cluster-analysis.html#subsetting-clusters"><i class="fa fa-check"></i><b>4.3.2</b> Subsetting Clusters</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="cluster-analysis.html"><a href="cluster-analysis.html#exploring-results"><i class="fa fa-check"></i><b>4.4</b> Exploring results</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="mars.html"><a href="mars.html"><i class="fa fa-check"></i><b>5</b> From Mars to Mull: Interplanetary comparison of soil XRPD data</a>
<ul>
<li class="chapter" data-level="5.1" data-path="mars.html"><a href="mars.html#data-and-packages"><i class="fa fa-check"></i><b>5.1</b> Data and packages</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="mars.html"><a href="mars.html#mars-science-laboratory-xrpd-data"><i class="fa fa-check"></i><b>5.1.1</b> Mars Science Laboratory XRPD Data</a></li>
<li class="chapter" data-level="5.1.2" data-path="mars.html"><a href="mars.html#scottish-soil-xrpd-data"><i class="fa fa-check"></i><b>5.1.2</b> Scottish Soil XRPD data</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="mars.html"><a href="mars.html#data-manipulation"><i class="fa fa-check"></i><b>5.2</b> Data manipulation</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="mars.html"><a href="mars.html#θ-transformation"><i class="fa fa-check"></i><b>5.2.1</b> 2θ transformation</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="mars.html"><a href="mars.html#θ-interpolation"><i class="fa fa-check"></i><b>5.3</b> 2θ interpolation</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="comparison-of-xrpd-data-from-scotland-and-mars.html"><a href="comparison-of-xrpd-data-from-scotland-and-mars.html"><i class="fa fa-check"></i><b>6</b> Comparison of XRPD data from Scotland and Mars</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Digital Soil Mineralogy with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="comparison-of-xrpd-data-from-scotland-and-mars" class="section level1" number="6">
<h1><span class="header-section-number">Chapter 6</span> Comparison of XRPD data from Scotland and Mars</h1>
<p>Now that the data are harmonised and therefore comparable, the final step is to derive the Pearson correlation coefficient of each MSL diffractogram to every Scottish diffractogram. This comparison should therefore yield 31 vectors each consisting of 774 correlation coefficients (thus 23,994 comparisons in total). In order to further enhance the accuracy of the derived correlation coefficients, each pairwise comparison will involve alignment of the 2 samples to one-another in order to correct for <a href="intro.html#alignment">common experimental aberrations</a> that can affect peak positions on the 2θ axis.</p>
<p>For this combined alignment and comparison, a function will be created that returns the Pearson correlation coefficient after aligning the two samples to one-another. Alignment of the two samples in each comparison to one-another will be achieved using the <code>align_xy</code> function that will accept 3 arguments:</p>
<ol style="list-style-type: decimal">
<li><code>mars</code> will be an <a href="intro.html#loading-data"><code>XY</code> object</a> of an MSL diffractogram.</li>
<li><code>scotland</code> will be an <code>XY</code> object of a Scottish soil diffractogram.</li>
<li><code>align</code> will define the maximum 2θ shift (either positive or negative) that can be applied.</li>
</ol>
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb211-1"><a href="comparison-of-xrpd-data-from-scotland-and-mars.html#cb211-1" aria-hidden="true" tabindex="-1"></a>compare_xrpd <span class="ot">&lt;-</span> <span class="cf">function</span>(mars, scotland, align) {</span>
<span id="cb211-2"><a href="comparison-of-xrpd-data-from-scotland-and-mars.html#cb211-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb211-3"><a href="comparison-of-xrpd-data-from-scotland-and-mars.html#cb211-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Align the two samples to one another using the multiXY method</span></span>
<span id="cb211-4"><a href="comparison-of-xrpd-data-from-scotland-and-mars.html#cb211-4" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">align_xy</span>(<span class="fu">as_multi_xy</span>(<span class="fu">list</span>(<span class="st">&quot;mars&quot;</span> <span class="ot">=</span> mars,</span>
<span id="cb211-5"><a href="comparison-of-xrpd-data-from-scotland-and-mars.html#cb211-5" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;scotland&quot;</span> <span class="ot">=</span> scotland)),</span>
<span id="cb211-6"><a href="comparison-of-xrpd-data-from-scotland-and-mars.html#cb211-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">std =</span> mars,</span>
<span id="cb211-7"><a href="comparison-of-xrpd-data-from-scotland-and-mars.html#cb211-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">xshift =</span> align,</span>
<span id="cb211-8"><a href="comparison-of-xrpd-data-from-scotland-and-mars.html#cb211-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">xmin =</span> <span class="fu">min</span>(mars[[<span class="dv">1</span>]]),</span>
<span id="cb211-9"><a href="comparison-of-xrpd-data-from-scotland-and-mars.html#cb211-9" aria-hidden="true" tabindex="-1"></a>                <span class="at">xmax =</span> <span class="fu">max</span>(mars[[<span class="dv">1</span>]]))</span>
<span id="cb211-10"><a href="comparison-of-xrpd-data-from-scotland-and-mars.html#cb211-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb211-11"><a href="comparison-of-xrpd-data-from-scotland-and-mars.html#cb211-11" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Correlate the count intensities to one-another</span></span>
<span id="cb211-12"><a href="comparison-of-xrpd-data-from-scotland-and-mars.html#cb211-12" aria-hidden="true" tabindex="-1"></a>  pearson <span class="ot">&lt;-</span> <span class="fu">cor</span>(x<span class="sc">$</span>mars[[<span class="dv">2</span>]], x<span class="sc">$</span>scotland[[<span class="dv">2</span>]])</span>
<span id="cb211-13"><a href="comparison-of-xrpd-data-from-scotland-and-mars.html#cb211-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb211-14"><a href="comparison-of-xrpd-data-from-scotland-and-mars.html#cb211-14" aria-hidden="true" tabindex="-1"></a>  <span class="co">#return the pearson correlation coefficient</span></span>
<span id="cb211-15"><a href="comparison-of-xrpd-data-from-scotland-and-mars.html#cb211-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(pearson)</span>
<span id="cb211-16"><a href="comparison-of-xrpd-data-from-scotland-and-mars.html#cb211-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb211-17"><a href="comparison-of-xrpd-data-from-scotland-and-mars.html#cb211-17" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Now that we have this in a function it will be applied across each of the diffractograms in <code>scotland_xrpd</code> using <code>sapply()</code>. For example, if we wanted to compare every diffractogram in <code>scotland_xrpd</code> to <code>mars_xrpd$Cumberland</code> we can use:</p>
<div class="sourceCode" id="cb212"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb212-1"><a href="comparison-of-xrpd-data-from-scotland-and-mars.html#cb212-1" aria-hidden="true" tabindex="-1"></a>cumberland_to_scotland <span class="ot">&lt;-</span> <span class="fu">sapply</span>(scotland_xrpd,</span>
<span id="cb212-2"><a href="comparison-of-xrpd-data-from-scotland-and-mars.html#cb212-2" aria-hidden="true" tabindex="-1"></a>                                 compare_xrpd,</span>
<span id="cb212-3"><a href="comparison-of-xrpd-data-from-scotland-and-mars.html#cb212-3" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">mars =</span> mars_xrpd<span class="sc">$</span>Cumberland,</span>
<span id="cb212-4"><a href="comparison-of-xrpd-data-from-scotland-and-mars.html#cb212-4" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">align =</span> <span class="fl">0.3</span></span>
<span id="cb212-5"><a href="comparison-of-xrpd-data-from-scotland-and-mars.html#cb212-5" aria-hidden="true" tabindex="-1"></a>                                 )</span></code></pre></div>
<p>Which yields a named vector of 774 correlation coefficients comparing <code>mars_xrpd$Cumberland</code> to every sample within <code>scotland_xrpd</code>, with each item within the vector being named according to the sample ID from the <code>scotland_xrpd</code> data.</p>
<div class="sourceCode" id="cb213"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb213-1"><a href="comparison-of-xrpd-data-from-scotland-and-mars.html#cb213-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Show the first six values of the names vector</span></span>
<span id="cb213-2"><a href="comparison-of-xrpd-data-from-scotland-and-mars.html#cb213-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(cumberland_to_scotland)</span></code></pre></div>
<pre><code>##   S1018719   S1018720   S1018728   S1018729   S1018737   S1018738 
## 0.12757117 0.14479395 0.10717699 0.10275806 0.07762731 0.10995736</code></pre>
<p>Now to derive the correlation coefficients for all 31 samples within the <code>mars_xrpd</code> data instead of just <code>mars$Cumberland</code>, a <code>for</code> loop will be used:</p>
<div class="sourceCode" id="cb215"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb215-1"><a href="comparison-of-xrpd-data-from-scotland-and-mars.html#cb215-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Create a blank list to populate</span></span>
<span id="cb215-2"><a href="comparison-of-xrpd-data-from-scotland-and-mars.html#cb215-2" aria-hidden="true" tabindex="-1"></a>mars_to_scotland <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb215-3"><a href="comparison-of-xrpd-data-from-scotland-and-mars.html#cb215-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb215-4"><a href="comparison-of-xrpd-data-from-scotland-and-mars.html#cb215-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(mars_xrpd)) {</span>
<span id="cb215-5"><a href="comparison-of-xrpd-data-from-scotland-and-mars.html#cb215-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb215-6"><a href="comparison-of-xrpd-data-from-scotland-and-mars.html#cb215-6" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Use sapply again to derive the named vector of coefficients</span></span>
<span id="cb215-7"><a href="comparison-of-xrpd-data-from-scotland-and-mars.html#cb215-7" aria-hidden="true" tabindex="-1"></a>  mars_to_scotland[[i]] <span class="ot">&lt;-</span> <span class="fu">sapply</span>(scotland_xrpd,</span>
<span id="cb215-8"><a href="comparison-of-xrpd-data-from-scotland-and-mars.html#cb215-8" aria-hidden="true" tabindex="-1"></a>                                  compare_xrpd,</span>
<span id="cb215-9"><a href="comparison-of-xrpd-data-from-scotland-and-mars.html#cb215-9" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">mars =</span> mars_xrpd[[i]],</span>
<span id="cb215-10"><a href="comparison-of-xrpd-data-from-scotland-and-mars.html#cb215-10" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">align =</span> <span class="fl">0.3</span></span>
<span id="cb215-11"><a href="comparison-of-xrpd-data-from-scotland-and-mars.html#cb215-11" aria-hidden="true" tabindex="-1"></a>                                  )</span>
<span id="cb215-12"><a href="comparison-of-xrpd-data-from-scotland-and-mars.html#cb215-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb215-13"><a href="comparison-of-xrpd-data-from-scotland-and-mars.html#cb215-13" aria-hidden="true" tabindex="-1"></a>  <span class="co">#name the list item</span></span>
<span id="cb215-14"><a href="comparison-of-xrpd-data-from-scotland-and-mars.html#cb215-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(mars_to_scotland)[i] <span class="ot">&lt;-</span> <span class="fu">names</span>(mars_xrpd)[i]</span>
<span id="cb215-15"><a href="comparison-of-xrpd-data-from-scotland-and-mars.html#cb215-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb215-16"><a href="comparison-of-xrpd-data-from-scotland-and-mars.html#cb215-16" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Which yields a list of 31 named vectors that each take the same form of <code>cumberland_to_scotland</code>. Each items within the list is named according to the MSL site name and consists of 774 numeric correlation coefficients:</p>
<div class="sourceCode" id="cb216"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb216-1"><a href="comparison-of-xrpd-data-from-scotland-and-mars.html#cb216-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mars_to_scotland)</span></code></pre></div>
<pre><code>##                  Length Class  Mode   
## Rocknest_4       774    -none- numeric
## Rocknest_5       774    -none- numeric
## Cumberland       774    -none- numeric
## John_Klein       774    -none- numeric
## Windjana         774    -none- numeric
## Confidence_Hills 774    -none- numeric
## Mojave2          774    -none- numeric
## Telegraph_Peak   774    -none- numeric
## Buckskin         774    -none- numeric
## Big_Sky          774    -none- numeric
## Greenhorn        774    -none- numeric
## Gobabeb_Dune     774    -none- numeric
## Lubango          774    -none- numeric
## Okoruso          774    -none- numeric
## Oudam            774    -none- numeric
## Marimba2         774    -none- numeric
## Quela            774    -none- numeric
## Sebina           774    -none- numeric
## Ogunquit_Beach   774    -none- numeric
## Duluth           774    -none- numeric
## Stoer            774    -none- numeric
## Aberlady         774    -none- numeric
## Kilmarie         774    -none- numeric
## Glen_Etive_1     774    -none- numeric
## Glen_Etive_2     774    -none- numeric
## Hutton           774    -none- numeric
## Edinburgh        774    -none- numeric
## Glasgow          774    -none- numeric
## Mary_Anning_1    774    -none- numeric
## Mary_Anning_3    774    -none- numeric
## Groken           774    -none- numeric</code></pre>
<p>By unlisting the <code>mars_to_scotland</code> data using <code>unlist()</code>, we end up with a very long vector consisting of 23,994 correlation coefficients, with each coefficient having a unique name that takes the form <code>MarsSite.ScotlandID</code>, for instance the name of the first item in the list is:</p>
<div class="sourceCode" id="cb218"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb218-1"><a href="comparison-of-xrpd-data-from-scotland-and-mars.html#cb218-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Create a vector from the mars_to_scotland list</span></span>
<span id="cb218-2"><a href="comparison-of-xrpd-data-from-scotland-and-mars.html#cb218-2" aria-hidden="true" tabindex="-1"></a>mars_to_scotland_v <span class="ot">&lt;-</span> <span class="fu">unlist</span>(mars_to_scotland)</span>
<span id="cb218-3"><a href="comparison-of-xrpd-data-from-scotland-and-mars.html#cb218-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb218-4"><a href="comparison-of-xrpd-data-from-scotland-and-mars.html#cb218-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Check the first correlation coefficient</span></span>
<span id="cb218-5"><a href="comparison-of-xrpd-data-from-scotland-and-mars.html#cb218-5" aria-hidden="true" tabindex="-1"></a>mars_to_scotland_v[<span class="dv">1</span>]</span></code></pre></div>
<pre><code>## Rocknest_4.S1018719 
##           0.1733916</code></pre>
<p>with the name <code>Rocknest_4.S1018719</code> detailing that the <code>mars_xrpd$Rocknest_4</code> and <code>scotland_xrpd$S1018719</code> samples were used to derive this correlation coefficient. It’s possible to plot the aligned data associated with these samples using:</p>
<div class="sourceCode" id="cb220"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb220-1"><a href="comparison-of-xrpd-data-from-scotland-and-mars.html#cb220-1" aria-hidden="true" tabindex="-1"></a>comparison <span class="ot">&lt;-</span> <span class="fu">align_xy</span>(<span class="fu">as_multi_xy</span>(<span class="fu">list</span>(<span class="st">&quot;Mars_Rocknest_4&quot;</span> <span class="ot">=</span> mars_xrpd<span class="sc">$</span>Rocknest_4,</span>
<span id="cb220-2"><a href="comparison-of-xrpd-data-from-scotland-and-mars.html#cb220-2" aria-hidden="true" tabindex="-1"></a>                                        <span class="st">&quot;Scotland_S1018719&quot;</span> <span class="ot">=</span> scotland_xrpd<span class="sc">$</span>S1018719)),</span>
<span id="cb220-3"><a href="comparison-of-xrpd-data-from-scotland-and-mars.html#cb220-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">std =</span> mars_xrpd<span class="sc">$</span>Rocknest_4,</span>
<span id="cb220-4"><a href="comparison-of-xrpd-data-from-scotland-and-mars.html#cb220-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">xshift =</span> <span class="fl">0.3</span>,</span>
<span id="cb220-5"><a href="comparison-of-xrpd-data-from-scotland-and-mars.html#cb220-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">xmin =</span> <span class="fl">4.52</span>,</span>
<span id="cb220-6"><a href="comparison-of-xrpd-data-from-scotland-and-mars.html#cb220-6" aria-hidden="true" tabindex="-1"></a>                       <span class="at">xmax =</span> <span class="fl">51.92</span>)</span>
<span id="cb220-7"><a href="comparison-of-xrpd-data-from-scotland-and-mars.html#cb220-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb220-8"><a href="comparison-of-xrpd-data-from-scotland-and-mars.html#cb220-8" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot the data</span></span>
<span id="cb220-9"><a href="comparison-of-xrpd-data-from-scotland-and-mars.html#cb220-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(comparison,</span>
<span id="cb220-10"><a href="comparison-of-xrpd-data-from-scotland-and-mars.html#cb220-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">wavelength =</span> <span class="st">&quot;Co&quot;</span>,</span>
<span id="cb220-11"><a href="comparison-of-xrpd-data-from-scotland-and-mars.html#cb220-11" aria-hidden="true" tabindex="-1"></a>     <span class="at">normalise =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-124"></span>
<img src="DigiMinR_files/figure-html/unnamed-chunk-124-1.png" alt="Sample mars_xrpd$Rocknest_4 and scotland_xrpd$S1018719 aligned and plotted against one-another." width="100%" />
<p class="caption">
Figure 6.1: Sample mars_xrpd<span class="math inline">\(Rocknest_4 and scotland_xrpd\)</span>S1018719 aligned and plotted against one-another.
</p>
</div>
<p>From this comparison it’s clear to see that these diffractograms are highly dissimilar, which is reflected in their relatively low correlation coefficient of 0.17. Now that all of the correlation coefficients are in a vector, they can easily be summarised and visualised:</p>
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb221-1"><a href="comparison-of-xrpd-data-from-scotland-and-mars.html#cb221-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Summarise the correlation coefficients</span></span>
<span id="cb221-2"><a href="comparison-of-xrpd-data-from-scotland-and-mars.html#cb221-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mars_to_scotland_v)</span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
## -0.2253  0.1164  0.1716  0.1795  0.2311  0.8091</code></pre>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb223-1"><a href="comparison-of-xrpd-data-from-scotland-and-mars.html#cb223-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Produce a histogram of the correlation coefficients</span></span>
<span id="cb223-2"><a href="comparison-of-xrpd-data-from-scotland-and-mars.html#cb223-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(<span class="st">&quot;pearson&quot;</span> <span class="ot">=</span> mars_to_scotland_v),</span>
<span id="cb223-3"><a href="comparison-of-xrpd-data-from-scotland-and-mars.html#cb223-3" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> pearson)) <span class="sc">+</span></span>
<span id="cb223-4"><a href="comparison-of-xrpd-data-from-scotland-and-mars.html#cb223-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">100</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb223-5"><a href="comparison-of-xrpd-data-from-scotland-and-mars.html#cb223-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Pearson correlation coefficient&quot;</span>) <span class="sc">+</span></span>
<span id="cb223-6"><a href="comparison-of-xrpd-data-from-scotland-and-mars.html#cb223-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Count&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-125"></span>
<img src="DigiMinR_files/figure-html/unnamed-chunk-125-1.png" alt="Histogram of all 23,994 correlation coefficients" width="100%" />
<p class="caption">
Figure 6.2: Histogram of all 23,994 correlation coefficients
</p>
</div>
<p>The summary of the data outlines how the correlation coefficients range from -0.2 to 0.9, with an average of ~0.2. The histogram displays an approximately normal distribution of correlation coefficients, but shows a small tail of values &gt;0.75, that can be further explored:</p>
<div class="sourceCode" id="cb224"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb224-1"><a href="comparison-of-xrpd-data-from-scotland-and-mars.html#cb224-1" aria-hidden="true" tabindex="-1"></a>high_cors <span class="ot">&lt;-</span> mars_to_scotland_v[mars_to_scotland_v <span class="sc">&gt;=</span> <span class="fl">0.75</span>]</span>
<span id="cb224-2"><a href="comparison-of-xrpd-data-from-scotland-and-mars.html#cb224-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-3"><a href="comparison-of-xrpd-data-from-scotland-and-mars.html#cb224-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Check the results</span></span>
<span id="cb224-4"><a href="comparison-of-xrpd-data-from-scotland-and-mars.html#cb224-4" aria-hidden="true" tabindex="-1"></a>high_cors</span></code></pre></div>
<pre><code>##    Cumberland.S926673    Cumberland.S926674    Cumberland.S968694 
##             0.7687338             0.8091307             0.7665140 
##    John_Klein.S926674       Lubango.S926500      Marimba2.S926499 
##             0.7810010             0.7567831             0.7533330 
##      Marimba2.S968695         Quela.S968695        Sebina.S968695 
##             0.8021795             0.7801234             0.7863120 
##        Duluth.S926674      Aberlady.S926676      Aberlady.S968695 
##             0.7522924             0.7530857             0.7752545 
##  Glen_Etive_2.S926674  Glen_Etive_2.S968694  Glen_Etive_2.S968695 
##             0.7610764             0.7585035             0.7974164 
##       Glasgow.S968695 Mary_Anning_1.S926674 Mary_Anning_1.S968695 
##             0.7790987             0.7597717             0.7635760 
## Mary_Anning_3.S926674 
##             0.7587199</code></pre>
<div class="sourceCode" id="cb226"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb226-1"><a href="comparison-of-xrpd-data-from-scotland-and-mars.html#cb226-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Extract the Mars site names</span></span>
<span id="cb226-2"><a href="comparison-of-xrpd-data-from-scotland-and-mars.html#cb226-2" aria-hidden="true" tabindex="-1"></a>high_cors_mars <span class="ot">&lt;-</span> <span class="fu">sub</span>(<span class="st">&quot;</span><span class="sc">\\</span><span class="st">..*&quot;</span>, <span class="st">&quot;&quot;</span>, <span class="fu">names</span>(high_cors))</span>
<span id="cb226-3"><a href="comparison-of-xrpd-data-from-scotland-and-mars.html#cb226-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb226-4"><a href="comparison-of-xrpd-data-from-scotland-and-mars.html#cb226-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Show the sites</span></span>
<span id="cb226-5"><a href="comparison-of-xrpd-data-from-scotland-and-mars.html#cb226-5" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(high_cors_mars)</span></code></pre></div>
<pre><code>##  [1] &quot;Cumberland&quot;    &quot;John_Klein&quot;    &quot;Lubango&quot;       &quot;Marimba2&quot;     
##  [5] &quot;Quela&quot;         &quot;Sebina&quot;        &quot;Duluth&quot;        &quot;Aberlady&quot;     
##  [9] &quot;Glen_Etive_2&quot;  &quot;Glasgow&quot;       &quot;Mary_Anning_1&quot; &quot;Mary_Anning_3&quot;</code></pre>
<div class="sourceCode" id="cb228"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb228-1"><a href="comparison-of-xrpd-data-from-scotland-and-mars.html#cb228-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Extract the Scotland sample IDs</span></span>
<span id="cb228-2"><a href="comparison-of-xrpd-data-from-scotland-and-mars.html#cb228-2" aria-hidden="true" tabindex="-1"></a>high_cors_scotland <span class="ot">&lt;-</span> <span class="fu">sub</span>(<span class="st">&#39;.*</span><span class="sc">\\</span><span class="st">.&#39;</span>, <span class="st">&#39;&#39;</span>, <span class="fu">names</span>(high_cors))</span>
<span id="cb228-3"><a href="comparison-of-xrpd-data-from-scotland-and-mars.html#cb228-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-4"><a href="comparison-of-xrpd-data-from-scotland-and-mars.html#cb228-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Show the samples</span></span>
<span id="cb228-5"><a href="comparison-of-xrpd-data-from-scotland-and-mars.html#cb228-5" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(high_cors_scotland)</span></code></pre></div>
<pre><code>## [1] &quot;S926673&quot; &quot;S926674&quot; &quot;S968694&quot; &quot;S926500&quot; &quot;S926499&quot; &quot;S968695&quot; &quot;S926676&quot;</code></pre>
<p>It’s also possible to plot the samples for each of the sites where high correlations are found. Here we’ll plot the site that displays the highest correlation to samples within the <code>scotland_xrpd</code> dataset:</p>
<div class="sourceCode" id="cb230"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb230-1"><a href="comparison-of-xrpd-data-from-scotland-and-mars.html#cb230-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Extrac the name of the site with the highest correlation coefficients</span></span>
<span id="cb230-2"><a href="comparison-of-xrpd-data-from-scotland-and-mars.html#cb230-2" aria-hidden="true" tabindex="-1"></a>highest_cor <span class="ot">&lt;-</span> <span class="fu">sub</span>(<span class="st">&quot;</span><span class="sc">\\</span><span class="st">..*&quot;</span>, <span class="st">&quot;&quot;</span>, <span class="fu">names</span>(high_cors)[<span class="fu">which.max</span>(high_cors)])</span>
<span id="cb230-3"><a href="comparison-of-xrpd-data-from-scotland-and-mars.html#cb230-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb230-4"><a href="comparison-of-xrpd-data-from-scotland-and-mars.html#cb230-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Extract the IDs of samples that correlate strongly with Cumberland</span></span>
<span id="cb230-5"><a href="comparison-of-xrpd-data-from-scotland-and-mars.html#cb230-5" aria-hidden="true" tabindex="-1"></a>scotland_ids <span class="ot">&lt;-</span> <span class="fu">sub</span>(<span class="st">&#39;.*</span><span class="sc">\\</span><span class="st">.&#39;</span>, <span class="st">&#39;&#39;</span>, <span class="fu">names</span>(high_cors)[<span class="fu">grep</span>(highest_cor, <span class="fu">names</span>(high_cors))])</span>
<span id="cb230-6"><a href="comparison-of-xrpd-data-from-scotland-and-mars.html#cb230-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb230-7"><a href="comparison-of-xrpd-data-from-scotland-and-mars.html#cb230-7" aria-hidden="true" tabindex="-1"></a>mars_highest_cor <span class="ot">&lt;-</span> <span class="fu">as_multi_xy</span>(<span class="fu">c</span>(mars_xrpd[highest_cor],</span>
<span id="cb230-8"><a href="comparison-of-xrpd-data-from-scotland-and-mars.html#cb230-8" aria-hidden="true" tabindex="-1"></a>                                  scotland_xrpd[scotland_ids]))</span>
<span id="cb230-9"><a href="comparison-of-xrpd-data-from-scotland-and-mars.html#cb230-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb230-10"><a href="comparison-of-xrpd-data-from-scotland-and-mars.html#cb230-10" aria-hidden="true" tabindex="-1"></a><span class="co">#align data</span></span>
<span id="cb230-11"><a href="comparison-of-xrpd-data-from-scotland-and-mars.html#cb230-11" aria-hidden="true" tabindex="-1"></a>mars_highest_cor <span class="ot">&lt;-</span> <span class="fu">align_xy</span>(mars_highest_cor,</span>
<span id="cb230-12"><a href="comparison-of-xrpd-data-from-scotland-and-mars.html#cb230-12" aria-hidden="true" tabindex="-1"></a>                             <span class="at">std =</span> mars_highest_cor[[<span class="dv">1</span>]],</span>
<span id="cb230-13"><a href="comparison-of-xrpd-data-from-scotland-and-mars.html#cb230-13" aria-hidden="true" tabindex="-1"></a>                             <span class="at">xshift =</span> <span class="fl">0.3</span>,</span>
<span id="cb230-14"><a href="comparison-of-xrpd-data-from-scotland-and-mars.html#cb230-14" aria-hidden="true" tabindex="-1"></a>                             <span class="at">xmin =</span> <span class="fl">4.52</span>,</span>
<span id="cb230-15"><a href="comparison-of-xrpd-data-from-scotland-and-mars.html#cb230-15" aria-hidden="true" tabindex="-1"></a>                             <span class="at">xmax =</span> <span class="fl">51.92</span>)</span>
<span id="cb230-16"><a href="comparison-of-xrpd-data-from-scotland-and-mars.html#cb230-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb230-17"><a href="comparison-of-xrpd-data-from-scotland-and-mars.html#cb230-17" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mars_highest_cor,</span>
<span id="cb230-18"><a href="comparison-of-xrpd-data-from-scotland-and-mars.html#cb230-18" aria-hidden="true" tabindex="-1"></a>     <span class="at">wavelength =</span> <span class="st">&quot;Co&quot;</span>,</span>
<span id="cb230-19"><a href="comparison-of-xrpd-data-from-scotland-and-mars.html#cb230-19" aria-hidden="true" tabindex="-1"></a>     <span class="at">normalise =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-127"></span>
<img src="DigiMinR_files/figure-html/unnamed-chunk-127-1.png" alt="Diffractogram from the Cumberland site plotted against 3 diffractograms from Scotland identified as having relatively high correlation to the Martian data." width="100%" />
<p class="caption">
Figure 6.3: Diffractogram from the Cumberland site plotted against 3 diffractograms from Scotland identified as having relatively high correlation to the Martian data.
</p>
</div>
<p>From this plot we can see how three samples from the <code>scotland_xrpd</code> data show notable similarity to the data from the Cumberland site in the MSL data. Of particular note is the very basal plane d-spacing of the predominant clay mineral within the samples, suggesting that perhaps similar clay minerals are observed in the samples from Mars and Scotland.</p>
<p>Further exploration of Scottish samples identified as having similar diffraction patterns to the Cumberland MSL sample can be achieved by exploring the data spatially and by understanding more about the Scottish soil samples:</p>
<div class="sourceCode" id="cb231"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb231-1"><a href="comparison-of-xrpd-data-from-scotland-and-mars.html#cb231-1" aria-hidden="true" tabindex="-1"></a><span class="fu">leaflet</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb231-2"><a href="comparison-of-xrpd-data-from-scotland-and-mars.html#cb231-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addTiles</span>() <span class="sc">%&gt;%</span></span>
<span id="cb231-3"><a href="comparison-of-xrpd-data-from-scotland-and-mars.html#cb231-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addCircleMarkers</span>(<span class="at">data =</span> scotland_locations[scotland_locations<span class="sc">$</span>SAMPLE_ID <span class="sc">%in%</span> scotland_ids,],</span>
<span id="cb231-4"><a href="comparison-of-xrpd-data-from-scotland-and-mars.html#cb231-4" aria-hidden="true" tabindex="-1"></a>                   <span class="sc">~</span>PROFILE_LONGITUDE, <span class="sc">~</span>PROFILE_LATITUDE,</span>
<span id="cb231-5"><a href="comparison-of-xrpd-data-from-scotland-and-mars.html#cb231-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>,</span>
<span id="cb231-6"><a href="comparison-of-xrpd-data-from-scotland-and-mars.html#cb231-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">opacity =</span> <span class="dv">1</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-128"></span>
<div id="htmlwidget-e68247c13f8408c30ded" style="width:80%;height:480px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-e68247c13f8408c30ded">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addTiles","args":["//{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",null,null,{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"attribution":"&copy; <a href=\"http://openstreetmap.org\">OpenStreetMap<\/a> contributors, <a href=\"http://creativecommons.org/licenses/by-sa/2.0/\">CC-BY-SA<\/a>"}]},{"method":"addCircleMarkers","args":[[56.480365753173,56.480365753173,57.555801391601],[-6.222881793975,-6.222881793975,-6.347044467926],10,null,null,{"interactive":true,"className":"","stroke":true,"color":"blue","weight":5,"opacity":1,"fill":true,"fillColor":"blue","fillOpacity":0.2},null,null,null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]}],"limits":{"lat":[56.480365753173,57.555801391601],"lng":[-6.347044467926,-6.222881793975]}},"evals":[],"jsHooks":[]}</script>
<p class="caption">
Figure 6.4: Interactive map of the locations of the Scottish soils that display the highest correlation to samples from the Cumberland MSL site.
</p>
</div>
<p>Plotting the data spatially reveals that the samples are both located on the West Coast of Scotland, located either on the Isle of Ulva, near Mull, or on the Trotternish Peninsula of the Isle of Skye. Both of these locations display soils developed from a basaltic parent material in combination with a relatively wet climate that has resulted in the weathering of this material to clay minerals.</p>

</div>
            </section>

          </div>
        </div>
      </div>
<a href="mars.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="references.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
